import SbtDependency from '@site/src/components/SbtDependency';

# Pekko Runtime

`PekkoRuntime` leverages [Pekko Persistence](https://pekko.apache.org/docs/pekko/current/typed/index-persistence.html) and [Cluster Sharding](https://pekko.apache.org/docs/pekko/current/typed/cluster-sharding.html) to provide a distributed runtime for workflows.

<SbtDependency moduleName={"workflows4s-pekko"}/>

## Example

Here is an example of using `PekkoRuntime` in a workflow:

```scala file=./main/scala/workflows4s/example/docs/pekko/PekkoExample.scala start=doc_start end=doc_end
```

## Caveats

While `PekkoRuntime` offers robust distributed capabilities, it comes with some caveats:

1. **Configuration Complexity**:
   - A significant amount of complexity is encapsulated within Pekko.
   - Proper configuration is essential to ensure smooth operation.
2. **Initial State Limitation**:
   - Unlike other runtimes, `PekkoRuntime` does not support arbitrary initial states during workflow instance creation. Initial state has to be build uniformly across all instances based on `EntityContext`.
3. **Shard Initialization**:
   - The `initializeShard` method must be invoked before creating workflow instances to ensure proper setup.
